/*! Angular Moment Picker - v0.6.6 - https://github.com/indrimuska/angular-moment-picker - (c) 2015 Indri Muska - MIT */
!function(a){"use strict";var b,c,d,e,f,g,h={up:38,down:40,left:37,right:39,escape:27,enter:13},i=function(){function b(){c={locale:"en",format:"L LTS",minView:"decade",maxView:"minute",startView:"year",autoclose:!0,today:!1,keyboard:!1,leftArrow:"&larr;",rightArrow:"&rarr;",yearsFormat:"YYYY",monthsFormat:"MMM",daysFormat:"D",hoursFormat:"HH:[00]",secondsFormat:"ss",minutesStep:5,secondsStep:1}}var c;return b.prototype.options=function(b){return a.extend(c,b),a.copy(c)},b.prototype.$get=function(){return c},b}(),j=function(){function i(a){var b,c,d,e;if(a)return a.getClientRects().length?(d=a.getBoundingClientRect(),d.width||d.height?(e=a.ownerDocument,c=null!=e&&e===e.window?a:9===e.nodeType&&e.defaultView,b=e.documentElement,{top:d.top+c.pageYOffset-b.clientTop,left:d.left+c.pageXOffset-b.clientLeft}):d):{top:0,left:0}}function j(a,h,i,j,k,l){this.restrict="A",this.scope={model:"=momentPicker",locale:"@?",format:"@?",minView:"@?",maxView:"@?",startView:"@?",minDate:"=?",maxDate:"=?",disabled:"=?disable",autoclose:"=?",today:"=?",keyboard:"=?",change:"&?",selectable:"&?"},b=a,c=h,d=i,e=j,f=k,g=l}return j.prototype.$inject=["$timeout","$sce","$compile","$log","$window","momentPicker"],j.prototype.link=function(j,k,l){j.template='<div class="moment-picker-container {{view.selected}}-view" ng-show="view.isOpen && !disabled" ng-class="{\'moment-picker-disabled\': disabled, \'open\': view.isOpen}"><table class="header-view"><thead><tr><th ng-class="{disabled: !view.previous.selectable}" ng-bind-html="view.previous.label" ng-click="view.previous.set()"></th><th ng-bind="view.title" ng-click="view.setParentView()"></th><th ng-class="{disabled: !view.next.selectable}" ng-bind-html="view.next.label" ng-click="view.next.set()"></th></tr></thead></table><div class="moment-picker-specific-views"><table ng-if="view.selected == \'decade\'"><tbody><tr ng-repeat="fourYear in decadeView.fourYears"><td ng-repeat="year in fourYear track by year.year" ng-class="year.class" ng-bind="year.label" ng-click="decadeView.setYear(year)"></td></tr></tbody></table><table ng-if="view.selected == \'year\'"><tbody><tr ng-repeat="fourMonth in yearView.fourMonths"><td ng-repeat="month in fourMonth track by month.month" ng-class="month.class" ng-bind="month.label" ng-click="yearView.setMonth(month)"></td></tr></tbody></table><table ng-if="view.selected == \'month\'"><thead><tr><th ng-repeat="day in monthView.days" ng-bind="day"></th></tr></thead><tbody><tr ng-repeat="days in monthView.weeks"><td ng-repeat="day in days track by day.date" ng-class="day.class" ng-bind="day.label" ng-click="monthView.setDay(day)"></td></tr></tbody></table><table ng-if="view.selected == \'day\'"><tbody><tr ng-repeat="threeHours in dayView.threeHours"><td ng-repeat="hour in threeHours track by hour.hour" ng-class="hour.class" ng-bind="hour.label" ng-click="dayView.setHour(hour)"></td></tr></tbody></table><table ng-if="view.selected == \'hour\'"><tbody><tr ng-repeat="minutes in hourView.minutes"><td ng-repeat="minute in minutes" ng-class="minute.class" ng-bind="minute.label" ng-click="hourView.setMinute(minute)"></td></tr></tbody></table><table ng-if="view.selected == \'minute\'"><tbody><tr ng-repeat="seconds in minuteView.seconds"><td ng-repeat="second in seconds" ng-class="second.class" ng-bind="second.label" ng-click="minuteView.setSecond(second)"></td></tr></tbody></table></div></div>',a.forEach(["locale","format","minView","maxView","startView","autoclose","today","keyboard","leftArrow","rightArrow"],function(b){a.isDefined(j[b])||(j[b]=g[b]),a.isDefined(l[b])||(l[b]=j[b])}),j.momentToDate=function(a){return j.isValidMoment(a)?a.clone().toDate():void 0},j.valueUpdate=function(){j.disabled||(j.value=j.momentToDate(j.valueMoment))},j.isValidMoment=function(b){return a.isDefined(b)&&b.isValid()},j.limits={isAfterOrEqualMin:function(b,c){return!a.isDefined(j.minDateMoment)||b.isAfter(j.minDateMoment,c)||b.isSame(j.minDateMoment,c)},isBeforeOrEqualMax:function(b,c){return!a.isDefined(j.maxDateMoment)||b.isBefore(j.maxDateMoment,c)||b.isSame(j.maxDateMoment,c)},isSelectable:function(b,c){var d=!0;try{a.isFunction(j.selectable)&&(d=j.selectable({date:b,type:c}))}catch(f){e.error(f)}return j.limits.isAfterOrEqualMin(b,c)&&j.limits.isBeforeOrEqualMax(b,c)&&d},checkValue:function(){a.isDefined(j.valueMoment)&&(j.limits.isAfterOrEqualMin(j.valueMoment)||j.valueUpdate(j.valueMoment=j.minDateMoment.clone()),j.limits.isBeforeOrEqualMax(j.valueMoment)||j.valueUpdate(j.valueMoment=j.maxDateMoment.clone()))},checkView:function(){a.isDefined(j.view.moment)||(j.view.moment=moment().locale(j.locale)),j.limits.isAfterOrEqualMin(j.view.moment)||(j.view.moment=j.minDateMoment.clone()),j.limits.isBeforeOrEqualMax(j.view.moment)||(j.view.moment=j.maxDateMoment.clone()),j.view.update()}},j.views={all:["decade","year","month","day","hour","minute"],formats:{decade:"Y{1,2}(?!Y)|YYYY|[Ll]{1,4}(?!T)",year:"M{1,4}(?![Mo])|Mo|Q",month:"[Dd]{1,4}(?![Ddo])|DDDo|[Dd]o|[Ww]{1,2}(?![Wwo])|[Ww]o|[Ee]|L{1,2}(?!T)|l{1,2}",day:"[Hh]{1,2}|LTS?",hour:"m{1,2}|[Ll]{3,4}|LT(?!S)",minute:"s{1,2}|S{1,}|X|LTS"},detectMinMax:function(){var b,c;a.forEach(j.views.formats,function(d,e){var f=new RegExp("("+d+")(?![^[]*])","g");j.format.match(f)&&(a.isDefined(b)||(b=e),c=e)}),b=a.isDefined(b)?Math.max(0,j.views.all.indexOf(b)):0,c=a.isDefined(c)?Math.min(j.views.all.length-1,j.views.all.indexOf(c)):j.views.all.length-1,b>j.views.all.indexOf(j.minView)&&(j.minView=j.views.all[b]),c<j.views.all.indexOf(j.maxView)&&(j.maxView=j.views.all[c])}},j.view={isOpen:!1,selected:j.startView,update:function(){j.view.value=j.momentToDate(j.view.moment)},toggle:function(){j.view.isOpen?j.view.close():j.view.open()},open:function(){j.disabled||j.view.isOpen||(j.view.isOpen=!0,b(j.view.position,0,!1))},close:function(){j.view.isOpen&&(j.view.isOpen=!1,j.view.selected=j.startView)},position:function(){j.picker.removeClass("top").removeClass("left");var a=j.container[0],b=i(a),c=b.top-f.pageYOffset,d=b.left-f.pageXOffset,e=f.innerWidth,g=f.innerHeight;c+f.pageYOffset-a.offsetHeight>0&&c>g/2&&j.picker.addClass("top"),d+a.offsetWidth>e&&j.picker.addClass("left")},keydown:function(a){var b=j.view.selected+"View",c={decade:"year",year:"month",month:"day",day:"hour",hour:"minute",minute:"second"}[j.view.selected],d=g[c+"sStep"]||1,e=[h.up,h.left].indexOf(a.keyCode)>=0?"subtract":"add";switch(a.keyCode){case h.up:case h.down:a.preventDefault(),j.view.isOpen?(j.view.update(j.view.moment[e](d*j[b].perLine,c)),j.view.render()):j.view.open();break;case h.left:case h.right:if(!j.view.isOpen)break;j.view.update(j.view.moment[e](d,c)),j.view.render(),a.preventDefault();break;case h.enter:if(!j.view.isOpen)break;j.view.change(c),a.preventDefault();break;case h.escape:j.view.toggle()}},unit:function(){return"decade"==j.view.selected?10:1},precision:function(){return j.view.selected.replace("decade","year")},title:"",previous:{label:c.trustAsHtml(j.leftArrow),selectable:!0,set:function(){j.view.previous.selectable&&j.view.update(j.view.moment.subtract(j.view.unit(),j.view.precision()).toDate())}},next:{selectable:!0,label:c.trustAsHtml(j.rightArrow),set:function(){j.view.next.selectable&&j.view.update(j.view.moment.add(j.view.unit(),j.view.precision()).toDate())}},setParentView:function(){j.view.change(j.views.all[Math.max(0,j.views.all.indexOf(j.view.selected)-1)])},render:function(){var a=j.view.moment.clone().startOf(j.view.precision()).subtract(j.view.unit(),j.view.precision()),b=j.view.moment.clone().endOf(j.view.precision()).add(j.view.unit(),j.view.precision());j.view.previous.selectable=j.limits.isAfterOrEqualMin(a,j.view.precision()),j.view.previous.label=c.trustAsHtml(j.view.previous.selectable?j.leftArrow:"&nbsp;"),j.view.next.selectable=j.limits.isBeforeOrEqualMax(b,j.view.precision()),j.view.next.label=c.trustAsHtml(j.view.next.selectable?j.rightArrow:"&nbsp;"),j.view.title=j[j.view.selected+"View"].render()},change:function(a){var b=j.views.all.indexOf(a),c=j.views.all.indexOf(j.minView),d=j.views.all.indexOf(j.maxView);0>b||b>d?(j.valueUpdate(j.valueMoment=j.view.moment.clone()),j.autoclose&&j.$evalAsync(j.view.close)):b>=c&&(j.view.selected=a)}},j.decadeView={perLine:4,fourYears:{},render:function(){var a=j.view.moment.clone(),b=10*Math.floor(a.year()/10)-1;a.year(b),j.decadeView.fourYears={};for(var c=0;12>c;c++){var d=Math.floor(c/4),e=j.limits.isSelectable(a,"year");j.decadeView.fourYears[d]||(j.decadeView.fourYears[d]=[]),j.decadeView.fourYears[d].push({label:a.format(g.yearsFormat),year:a.year(),"class":[j.keyboard&&a.isSame(j.view.moment,"year")?"highlighted":"",!e||[0,11].indexOf(c)>=0?"disabled":j.isValidMoment(j.valueMoment)&&a.isSame(j.valueMoment,"year")?"selected":""].join(" ").trim(),selectable:e}),a.add(1,"years")}return[a.subtract(2,"years").format("YYYY"),a.subtract(9,"years").format("YYYY")].reverse().join(" - ")},setYear:function(a){a.selectable&&(j.view.update(j.view.moment.year(a.year)),j.view.change("year"))}},j.yearView={perLine:4,fourMonths:{},render:function(){var a=j.view.moment.clone().startOf("year"),b=moment.monthsShort();return j.yearView.fourMonths={},b.forEach(function(b,c){var d=Math.floor(c/4),e=j.limits.isSelectable(a,"month");j.yearView.fourMonths[d]||(j.yearView.fourMonths[d]=[]),j.yearView.fourMonths[d].push({label:a.format(g.monthsFormat),year:a.year(),month:a.month(),"class":[j.keyboard&&a.isSame(j.view.moment,"month")?"highlighted":"",e?j.isValidMoment(j.valueMoment)&&a.isSame(j.valueMoment,"month")?"selected":"":"disabled"].join(" ").trim(),selectable:e}),a.add(1,"months")}),j.view.moment.format("YYYY")},setMonth:function(a){a.selectable&&(j.view.update(j.view.moment.year(a.year).month(a.month)),j.view.change("month"))}},j.monthView={perLine:moment.weekdays().length,days:moment.weekdays().map(function(a,b){return moment().locale(j.locale).startOf("week").add(b,"day").format("dd")}),weeks:[],render:function(){var b=j.view.moment.month(),c=j.view.moment.clone().startOf("month").startOf("week").hour(12),d={},e=c.week(),f=e+5;j.monthView.weeks=[];for(var h=e;f>=h;h++)d[h]=Array.apply(null,Array(j.monthView.perLine)).map(function(){var a=j.limits.isSelectable(c,"day"),d={label:c.format(g.daysFormat),year:c.year(),date:c.date(),month:c.month(),"class":[j.keyboard&&c.isSame(j.view.moment,"day")?"highlighted":"",j.today&&c.isSame(new Date,"day")?"today":"",a&&c.month()==b?j.isValidMoment(j.valueMoment)&&c.isSame(j.valueMoment,"day")?"selected":"":"disabled"].join(" ").trim(),selectable:a};return c.add(1,"days"),d});return a.forEach(d,function(a){j.monthView.weeks.push(a)}),j.view.moment.format("MMMM YYYY")},setDay:function(a){a.selectable&&(j.view.update(j.view.moment.year(a.year).month(a.month).date(a.date)),j.view.change("day"))}},j.dayView={perLine:4,threeHours:[],render:function(){var a=j.view.moment.clone().startOf("day");j.dayView.threeHours=[];for(var b=0;24>b;b++){var c=Math.floor(b/j.dayView.perLine),d=j.limits.isSelectable(a,"hour");j.dayView.threeHours[c]||(j.dayView.threeHours[c]=[]),j.dayView.threeHours[c].push({label:a.format(g.hoursFormat),year:a.year(),month:a.month(),date:a.date(),hour:a.hour(),"class":[j.keyboard&&a.isSame(j.view.moment,"hour")?"highlighted":"",d?j.isValidMoment(j.valueMoment)&&a.isSame(j.valueMoment,"hour")?"selected":"":"disabled"].join(" ").trim(),selectable:d}),a.add(1,"hours")}return j.view.moment.format("LL")},setHour:function(a){a.selectable&&(j.view.update(j.view.moment.year(a.year).month(a.month).date(a.date).hour(a.hour)),j.view.change("hour"))}},j.hourView={perLine:4,minutes:[],render:function(){var a=0,b=j.view.moment.clone().startOf("hour"),c=g.minutesFormat||moment.localeData(j.locale).longDateFormat("LT").replace(/[aA]/,"");j.hourView.minutes=[];for(var d=0;60>d;d+=g.minutesStep){var e=Math.floor(a/j.hourView.perLine),f=j.limits.isSelectable(b,"minute");j.hourView.minutes[e]||(j.hourView.minutes[e]=[]),j.hourView.minutes[e].push({label:b.format(c),year:b.year(),month:b.month(),date:b.date(),hour:b.hour(),minute:b.minute(),"class":[j.keyboard&&b.isSame(j.view.moment,"minute")?"highlighted":"",f?j.isValidMoment(j.valueMoment)&&b.isSame(j.valueMoment,"minute")?"selected":"":"disabled"].join(" ").trim(),selectable:f}),a++,b.add(g.minutesStep,"minutes")}return j.keyboard&&j.hourView.highlightClosest(),j.view.moment.clone().startOf("hour").format("lll")},setMinute:function(a){a.selectable&&(j.view.update(j.view.moment.year(a.year).month(a.month).date(a.date).hour(a.hour).minute(a.minute)),j.view.change("minute"))},highlightClosest:function(){var b,c=[];a.forEach(j.hourView.minutes,function(b){a.forEach(b,function(a){Math.abs(a.minute-j.view.moment.minute())<g.minutesStep&&c.push(a)})}),b=c.sort(function(a,b){return Math.abs(a.minute-j.view.moment.minute())>Math.abs(b.minute-j.view.moment.minute())})[0],b.minute-j.view.moment.minute()!=0&&(j.view.update(j.view.moment.year(b.year).month(b.month).date(b.date).hour(b.hour).minute(b.minute)),b.selectable&&(b["class"]=(b["class"]+" highlighted").trim()))}},j.minuteView={perLine:6,seconds:[],render:function(){var a=0,b=j.view.moment.clone().startOf("minute");j.minuteView.seconds=[];for(var c=0;60>c;c+=g.secondsStep){var d=Math.floor(a/j.minuteView.perLine),e=j.limits.isSelectable(b,"second");j.minuteView.seconds[d]||(j.minuteView.seconds[d]=[]),j.minuteView.seconds[d].push({label:b.format(g.secondsFormat),year:b.year(),month:b.month(),date:b.date(),hour:b.hour(),minute:b.minute(),second:b.second(),"class":[j.keyboard&&b.isSame(j.view.moment,"second")?"highlighted":"",e?j.isValidMoment(j.valueMoment)&&b.isSame(j.valueMoment,"second")?"selected":"":"disabled"].join(" ").trim(),selectable:e}),a++,b.add(g.secondsStep,"seconds")}return j.keyboard&&j.minuteView.highlightClosest(),j.view.moment.clone().startOf("minute").format("lll")},setSecond:function(a){a.selectable&&(j.view.update(j.view.moment.year(a.year).month(a.month).date(a.date).hour(a.hour).minute(a.minute).second(a.second)),j.view.change("second"))},highlightClosest:function(){var b,c=[];a.forEach(j.minuteView.seconds,function(b){a.forEach(b,function(a){Math.abs(a.second-j.view.moment.second())<g.secondsStep&&c.push(a)})}),b=c.sort(function(a,b){return Math.abs(a.second-j.view.moment.second())>Math.abs(b.second-j.view.moment.second())})[0],b.second-j.view.moment.second()!=0&&(j.view.update(j.view.moment.year(b.year).month(b.month).date(b.date).hour(b.hour).minute(b.minute).second(b.second)),b.selectable&&(b["class"]=(b["class"]+" highlighted").trim()))}},j.picker=a.element('<span class="moment-picker"></span>'),k.after(j.picker),j.contents=k.addClass("moment-picker-contents").removeAttr("moment-picker"),j.container=d(j.template)(j),j.picker.append(j.contents),j.picker.append(j.container),j.input="input"!=j.contents[0].tagName.toLowerCase()&&j.contents[0].querySelectorAll("input").length>0?a.element(j.contents[0].querySelectorAll("input")):a.element(j.contents[0]),j.input.attr("tabindex",0),j.views.detectMinMax(),j.limits.checkView(),j.$watch("model",function(b){a.isDefined(b)&&(j.valueMoment=moment(b,j.format,j.locale),j.valueMoment.isValid()?(j.view.moment=j.valueMoment.clone(),j.view.update()):j.valueMoment=void 0),j.valueUpdate(j.valueMoment),j.limits.checkValue()}),j.$watch("value",function(){if(a.isDefined(j.valueMoment)){var c=j.model,d=j.valueMoment.format(j.format);d!=c&&b(function(){j.view.update(j.view.moment=j.valueMoment.clone()),j.model=d,a.isFunction(j.change)&&b(function(){j.change({newValue:d,oldValue:c})},0,!1)})}}),j.$watch("[view.selected, view.value]",j.view.render,!0),j.$watch("[minView, maxView]",function(){j.views.detectMinMax(),j.startView=j.views.all[Math.max(Math.min(j.views.all.indexOf(j.startView),j.views.all.indexOf(j.maxView)),j.views.all.indexOf(j.minView))],j.view.selected=j.startView}),j.$watch("[minDate, maxDate]",function(){a.forEach(["minDate","maxDate"],function(b){a.isDefined(j[b])&&(j[b+"Moment"]=moment(j[b],j.format,j.locale),j[b+"Moment"].isValid()||(j[b+"Moment"]=void 0))}),j.limits.checkValue(),j.limits.checkView(),j.view.render()},!0),j.$watch("locale",function(b,c){a.isDefined(c)&&b!=c&&(a.forEach(["model","minDate","maxDate"],function(d){a.isDefined(j[d])&&(j[d]=moment(j[d],j.format,c).locale(b).format(j.format))}),j.view.render())}),j.focusInput=function(a){a.preventDefault(),j.input[0].focus()},j.input.on("focus click",function(){j.$evalAsync(j.view.open)}).on("blur",function(){j.$evalAsync(j.view.close)}).on("keydown",function(a){j.keyboard&&j.$evalAsync(function(){j.view.keydown(a)})}),j.contents.on("mousedown",j.focusInput),j.container.on("mousedown",j.focusInput),a.element(f).on("resize scroll",j.view.position)},j}();a.module("moment-picker",[]).provider("momentPicker",[function(){return new i}]).directive("momentPicker",["$timeout","$sce","$compile","$log","$window","momentPicker",function(a,b,c,d,e,f){return new j(a,b,c,d,e,f)}])}(window.angular);